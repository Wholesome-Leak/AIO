using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Threading;
using AIO;
using AIO.Combat.Common;
using robotManager.Helpful;
using wManager.Events;
using wManager.Wow.Helpers;

// Token: 0x02000015 RID: 21
internal class TalentsManager : ICycleable
{
	// Token: 0x0600005F RID: 95 RVA: 0x00006E44 File Offset: 0x00005044
	public static bool HaveTalent(int tree, int talentNumber)
	{
		int num = Lua.LuaDoString<int>(string.Concat(new string[]
		{
			"_, _, _, _, currentRank, _, _, _ = GetTalentInfo(",
			tree.ToString(),
			", ",
			talentNumber.ToString(),
			"); return currentRank;"
		}), "");
		return num > 0;
	}

	// Token: 0x06000060 RID: 96 RVA: 0x00006E9C File Offset: 0x0000509C
	public static void Set(bool assignTalents, bool useDefaultTalents, string[] customTalentsCodes, string specialisation = null)
	{
		bool flag = !assignTalents;
		if (flag)
		{
			TalentsManager.Codes = null;
		}
		else
		{
			if (useDefaultTalents)
			{
				TalentsManager.SetTalentCodes(specialisation);
				Main.Log("Your are using the following default talents build:");
			}
			else
			{
				TalentsManager.SetTalentCodes(customTalentsCodes);
				Main.Log("Your are using the following custom talents build:");
			}
			bool flag2 = TalentsManager.Codes.Any<string>();
			if (flag2)
			{
				Main.Log(TalentsManager.Codes.Last<string>());
			}
			else
			{
				Main.LogError("No talent code");
			}
		}
	}

	// Token: 0x06000061 RID: 97 RVA: 0x00006F1C File Offset: 0x0000511C
	private static void SetTalentCodes(string specialisation = null)
	{
		uint num = <PrivateImplementationDetails>.ComputeStringHash(specialisation);
		if (num <= 1679560732U)
		{
			if (num <= 859143881U)
			{
				if (num <= 316464933U)
				{
					if (num != 208206859U)
					{
						if (num != 305643670U)
						{
							if (num == 316464933U)
							{
								if (specialisation == "WarriorFury")
								{
									TalentsManager.Codes = new string[]
									{
										"0000000000000000000000000000000305020030000000000000000000000000000000000000000000000",
										"0000000000000000000000000000000305022030500010000000000000000000000000000000000000000",
										"0000000000000000000000000000000305022030500310000000000000000000000000000000000000000",
										"0000000000000000000000000000000305022030501310050120000000000000000000000000000000000",
										"0000000000000000000000000000000305022030501310052120500300000000000000000000000000000",
										"0000000000000000000000000000000305022030501310053120500300000000000000000000000000000",
										"0000000000000000000000000000000305022030502310053120500351000000000000000000000000000",
										"0000000000000000000000000000000305022030504310053120500351000000000000000000000000000",
										"3500200023300000000000000000000305022030504310053120500351000000000000000000000000000"
									};
								}
							}
						}
						else if (specialisation == "WarlockDestruction")
						{
							TalentsManager.Codes = new string[]
							{
								"000000000000000000000000000000000000000000000000000000005000000000000000000000000",
								"000000000000000000000000000000020000000000000000000000005000000000000000000000000",
								"000000000000000000000000000000020000000000000000000000005203205210331051335230351",
								"000000000000000000000000000003320030002000000000000000005203205210331051335230351"
							};
						}
					}
					else if (specialisation == "HunterMarksmanship")
					{
						TalentsManager.Codes = new string[]
						{
							"000000000000000000000000000320050312300000000000000000000000000000000000000000000",
							"000000000000000000000000000321050312300130000000000000000000000000000000000000000",
							"000000000000000000000000000322050312300132301300000000000000000000000000000000000",
							"000000000000000000000000000323050312300132301350010000000000000000000000000000000",
							"000000000000000000000000000323050312300132301350311510000000000000000000000000000",
							"000000000000000000000000000353050312300132301350313510000000000000000000000000000",
							"000000000000000000000000000353050312300132301350313515000002000000000000000000000",
							"500002000000000000000000000353050312300132301350313515000002000000000000000000000",
							"501002000000000000000000000353050312300132301350313515000002000000000000000000000"
						};
					}
				}
				else if (num <= 590109611U)
				{
					if (num != 526545426U)
					{
						if (num == 590109611U)
						{
							if (specialisation == "WarlockDemonology")
							{
								TalentsManager.Codes = new string[]
								{
									"000000000000000000000000000000320330113520253013300100000000000000000000000000000",
									"000000000000000000000000000000320330113520253013523134100000000000000000000000000",
									"000000000000000000000000000000320330113520253013523134155000005000000000000000000"
								};
							}
						}
					}
					else if (specialisation == "PriestShadow")
					{
						TalentsManager.Codes = new string[]
						{
							"0000000000000000000000000000000000000000000000000000000300000000000000000000000000",
							"0000000000000000000000000000000000000000000000000000000302023001000000000000000000",
							"0000000000000000000000000000000000000000000000000000000302023041003000000000000000",
							"0000000000000000000000000000000000000000000000000000000302023051013010000000000000",
							"0000000000000000000000000000000000000000000000000000000304023051013012023100000000",
							"0000000000000000000000000000000000000000000000000000000304023051013012023140300000",
							"0000000000000000000000000000000000000000000000000000000304023051013012023151301000",
							"0000000000000000000000000000000000000000000000000000000304023051013012023152301000",
							"0000000000000000000000000000000000000000000000000000000305023051213012023152301051",
							"0503200100000000000000000000000000000000000000000000000305023051213012023152301051",
							"0503203100000000000000000000000000000000000000000000000325023051223012323152301051"
						};
					}
				}
				else if (num != 616867151U)
				{
					if (num == 859143881U)
					{
						if (specialisation == "RogueCombat")
						{
							TalentsManager.Codes = new string[]
							{
								"00000000000000000000000000002303201000000000000000000000000000000000000000000000000",
								"00000000000000000000000000002303521000040100000000000000000000000000000000000000000",
								"00000000000000000000000000002513521000050100000000000000000000000000000000000000000",
								"00000000000000000000000000002513521000050102200000000000000000000000000000000000000",
								"00000000000000000000000000002523521000050102201000000000000000000000000000000000000",
								"00000000000000000000000000002523521000050102231000000000000000000000000000000000000",
								"00000000000000000000000000002523521000150102231005010000000000000000000000000000000",
								"00000000000000000000000000002523521000150102231005212510000000000000000000000000000",
								"02000000000000000000000000002523521000150102231005212510000000000000000000000000000",
								"32500010504000000000000000002523521000150102231005212510000000000000000000000000000"
							};
						}
					}
				}
				else if (specialisation == "MageFrost")
				{
					TalentsManager.Codes = new string[]
					{
						"00000000000000000000000000000000000000000000000000000000000503020010000000000000000000",
						"00000000000000000000000000000000000000000000000000000000000503020310000000000000000000",
						"00000000000000000000000000000000000000000000000000000000000503030310000000000000000000",
						"00000000000000000000000000000000000000000000000000000000000503030310003000000000000000",
						"00000000000000000000000000000000000000000000000000000000002503030310003100000000000000",
						"00000000000000000000000000000000000000000000000000000000003503030310203110030000000000",
						"00000000000000000000000000000000000000000000000000000000003503030310203110230142200000",
						"00000000000000000000000000000000000000000000000000000000003503030310203110230152201000",
						"00000000000000000000000000000000000000000000000000000000003503030310203130230152201000",
						"00000000000000000000000000000000000000000000000000000000003523030310203130230152201051",
						"23000503200003000000000000000000000000000000000000000000003523030310203130230152201051",
						"23000503310003000000000000000000000000000000000000000000003523030310203130230152201051"
					};
				}
			}
			else if (num <= 1447382081U)
			{
				if (num <= 1188192373U)
				{
					if (num != 991084565U)
					{
						if (num == 1188192373U)
						{
							if (specialisation == "WarlockAffliction")
							{
								TalentsManager.Codes = new string[]
								{
									"033002200100000000000000000000000000000000000000000000000000000000000000000000000",
									"235002200100300000000000000000000000000000000000000000000000000000000000000000000",
									"235002200102301000000000000000000000000000000000000000000000000000000000000000000",
									"235002200102341023001000000000000000000000000000000000000000000000000000000000000",
									"235002200102341023301000000000000000000000000000000000000000000000000000000000000",
									"235002200102341023351010110000000000000000000000000000000000000000000000000000000",
									"235002200102341023351013115100000000000000000000000000000000000000000000000000000",
									"235002200102341023351013115100020000000000000000000000000000000000000000000000000",
									"235002200102351023351033115100322030113020000000000000000000000000000000000000000"
								};
							}
						}
					}
					else if (specialisation == "PaladinRetribution")
					{
						TalentsManager.Codes = new string[]
						{
							"000000000000000000000000000000000000000000000000000005230041003231000000000000",
							"000000000000000000000000000000000000000000000000000005230051003231300000000000",
							"000000000000000000000000000000000000000000000000000005230051203231301133201300",
							"000000000000000000000000000000000000000000000000000005230051203231302133201330",
							"000000000000000000000000000000000000000000000000000005230051203231302133221331",
							"000000000000000000000000000500000000000000000000000005230051203231302133221331",
							"000000000000000000000000000500000000000000000000000005232251223331322133231331",
							"050000000000000000000000000500000000000000000000000005232251223331322133231331"
						};
					}
				}
				else if (num != 1314009215U)
				{
					if (num == 1447382081U)
					{
						if (specialisation == "MageArcane")
						{
							TalentsManager.Codes = new string[]
							{
								"23500503110023015032310250532100000000000000000000000000000000000000000000000000000000",
								"23500503110023015032310250532100000000000000000000000000002030230010000000000000000000",
								"23500503110023015032310250532102000000000000000000000000002030230010000000000000000000"
							};
						}
					}
				}
				else if (specialisation == "ShamanEnhancement")
				{
					TalentsManager.Codes = new string[]
					{
						"00000000000000000000000003020500010000000000000000000000000000000000000000000000",
						"00000000000000000000000003020500310000000000000000000000000000000000000000000000",
						"00000000000000000000000003020501310500130000000000000000000000000000000000000000",
						"00000000000000000000000003020502310500130300000000000000000000000000000000000000",
						"00000000000000000000000003020502310500132300100000000000000000000000000000000000",
						"00000000000000000000000003020502310500132303110120000000000000000000000000000000",
						"00000000000000000000000003020502310500132303112120100000000000000000000000000000",
						"00000000000000000000000003020502310500132303112123100000000000000000000000000000",
						"00000000000000000000000003020502310500133303112123105100000000000000000000000000",
						"00000000000000000000000003020503310500133303113123105100000000000000000000000000",
						"05003000000000000000000003020503310500133303113123105100000000000000000000000000",
						"05003000000000000000000003020503310500133303113123105100000000000000000000000000",
						"05203015000000000000000003020503310502133303113123105100000000000000000000000000"
					};
				}
			}
			else if (num <= 1485506981U)
			{
				if (num != 1481822501U)
				{
					if (num == 1485506981U)
					{
						if (specialisation == "DeathKnightUnholy")
						{
							TalentsManager.Codes = new string[]
							{
								"0000000000000000000000000000000000000000000000000000000002302003320032102000000000000000",
								"0000000000000000000000000000000000000000000000000000000002302003320032122000100000000000",
								"0000000000000000000000000000000000000000000000000000000002302003350032132000100000000000",
								"0000000000000000000000000000000000000000000000000000000002302003350032132000150003100000",
								"0000000000000000000000000000000000000000000000000000000002302003350032152000150003100000",
								"0000000000000000000000000000000000000000000000000000000002302003350032152000150003133151",
								"2305020500000000000000000000000000000000000000000000000002302003350032152000150003133151"
							};
						}
					}
				}
				else if (specialisation == "DruidRestoration")
				{
					TalentsManager.Codes = new string[]
					{
						"0000000000000000000000000000000000000000000000000000000000230033310030000000000000000",
						"0000000000000000000000000000000000000000000000000000000000230033312030000000000000000",
						"0000000000000000000000000000000000000000000000000000000000230033312031400530000000000",
						"0000000000000000000000000000000000000000000000000000000000230033312031500531000000000",
						"0000000000000000000000000000000000000000000000000000000000230033312031500531003000000",
						"0000000000000000000000000000000000000000000000000000000000230033312031500531053013000",
						"0000000000000000000000000000000000000000000000000000000000230033312031500531053313051",
						"0532000100000000000000000000000000000000000000000000000000230033312031500531053313051",
						"0532000100000000000000000000000000000000000000000000000000230033312031502531253313051"
					};
				}
			}
			else if (num != 1570894369U)
			{
				if (num == 1679560732U)
				{
					if (specialisation == "ShamanElemental")
					{
						TalentsManager.Codes = new string[]
						{
							"35300015032133513223013510000000000000000000000000000000000000000000000000000000",
							"35300015032133513223013510050500310000000000000000000000000000000000000000000000",
							"35300015032133513223013510050520310000000000000000000000000000000000000000000000"
						};
					}
				}
			}
			else if (specialisation == "RogueSublety")
			{
				TalentsManager.Codes = new string[]
				{
					"00000000000000000000000000000000000000000000000000000005020232010322120150135031251",
					"00530310000000000000000000000000000000000000000000000005020232010322120150135031251",
					"00532310000000000000000000000000000000000000000000000005020232010322120150135031251",
					"00532310000000000000000000000000000000000000000000000005020232010322120350135231251",
					"00532310000000000000000000000000000000000000000000000005020232020322120350135231251"
				};
			}
		}
		else if (num <= 3047166388U)
		{
			if (num <= 2045691198U)
			{
				if (num != 1795892981U)
				{
					if (num != 1796991055U)
					{
						if (num == 2045691198U)
						{
							if (specialisation == "WarriorProtection")
							{
								TalentsManager.Codes = new string[]
								{
									"0000000000000000000000000000000000000000000000000000000000053020200000000000000000000",
									"0000000000000000000000000000000000000000000000000000000000053020220000000000000000000",
									"0000000000000000000000000000000000000000000000000000000000053051222000010000000000000",
									"0000000000000000000000000000000000000000000000000000000000053351223000010501000000000",
									"0000000000000000000000000000000000000000000000000000000000053351223000010521230000000",
									"0000000000000000000000000000000000000000000000000000000000053351223000110521330113321",
									"0000000000000000000000000000000000000000000000000000000000053351225000210521330113321",
									"0000000000000000000000000000000300000000000000000000000000053351225000210521330113321",
									"0502000000000000000000000000000305000000000000000000000000053351225000212521330113321"
								};
							}
						}
					}
					else if (specialisation == "MageFire")
					{
						TalentsManager.Codes = new string[]
						{
							"00000000000000000000000000000000550300023000000000000000000000000000000000000000000000",
							"00000000000000000000000000000001550300123000300000000000000000000000000000000000000000",
							"00000000000000000000000000000001550300123002300501000000000000000000000000000000000000",
							"00000000000000000000000000000001550300123003300531023003000000000000000000000000000000",
							"00000000000000000000000000000001550300123003310531023213310000000000000000000000000000",
							"00000000000000000000000000000001550300123003310531023213510000000000000000000000000000",
							"23000500010000000000000000000001550300123003310531023213510000000000000000000000000000",
							"23000503110003000000000000000001550300123003310531023213510000000000000000000000000000"
						};
					}
				}
				else if (specialisation == "DruidFeral")
				{
					TalentsManager.Codes = new string[]
					{
						"0000000000000000000000000000500200000000000000000000000000000000000000000000000000000",
						"0000000000000000000000000000503200030000000000000000000000000000000000000000000000000",
						"0000000000000000000000000000503202030302000000000000000000000000000000000000000000000",
						"0000000000000000000000000000503202030322000000000000000000000000000000000000000000000",
						"0000000000000000000000000000503202032322010050120000000000000000000000000000000000000",
						"0000000000000000000000000000503202032322010052120030000000000000000000000000000000000",
						"0000000000000000000000000000503202032322010053120030000000000000000000000000000000000",
						"0000000000000000000000000000503202032322011053120030010000000000000000000000000000000",
						"0000000000000000000000000000503202032322011053120030311501000000000000000000000000000",
						"0000000000000000000000000000503202032322011053120030313511000000000000000000000000000",
						"0000000000000000000000000000503202032322011053120030313511203500010000000000000000000",
						"0000000000000000000000000000503202032322011053120030313511203503012000000000000000000",
						"0000000000000000000000000000503202032322012053120030313511203503012000000000000000000"
					};
				}
			}
			else if (num <= 2692627762U)
			{
				if (num != 2410709804U)
				{
					if (num == 2692627762U)
					{
						if (specialisation == "PaladinHoly")
						{
							TalentsManager.Codes = new string[]
							{
								"503501510200130531005152210000000000000000000000000000000000000000000000000000",
								"503501510200130531005152210000000000000000000000000005032050000000000000000000",
								"503501510200130531005152215000000000000000000000000005032050000000000000000000"
							};
						}
					}
				}
				else if (specialisation == "DeathKnightBlood")
				{
					TalentsManager.Codes = new string[]
					{
						"2305020530003303231023101351000000000000000000000000000002302203050030000000000000000000",
						"2305020530003303231023101351000000000000000000000000000002302203050030000000000000000000"
					};
				}
			}
			else if (num != 2989400989U)
			{
				if (num == 3047166388U)
				{
					if (specialisation == "PriestDiscipline")
					{
						TalentsManager.Codes = new string[]
						{
							"0503203130300512331323231251000000000000000000000000000000000000000000000000000000",
							"0503203130300512331323231251005501030000000000000000000000000000000000000000000000"
						};
					}
				}
			}
			else if (specialisation == "ShamanRestoration")
			{
				TalentsManager.Codes = new string[]
				{
					"00000000000000000000000000000000000000000000000000000050005301300000000000000000",
					"00000000000000000000000000000000000000000000000000000050005301330310000000000000",
					"00000000000000000000000000000000000000000000000000000050005331330310501000000000",
					"00000000000000000000000000000000000000000000000000000050005331332310501022331251",
					"00000000000000000000000000050500100000000000000000000050005331335310501022331251",
					"00000000000000000000000000050503100000000000000000000050005331335310501022331251"
				};
			}
		}
		else if (num <= 3880399577U)
		{
			if (num <= 3437009319U)
			{
				if (num != 3294476013U)
				{
					if (num == 3437009319U)
					{
						if (specialisation == "PaladinProtection")
						{
							TalentsManager.Codes = new string[]
							{
								"000000000000000000000000000500513120310000000000000000000000000000000000000000",
								"000000000000000000000000000500513520310000000000000000000000000000000000000000",
								"000000000000000000000000000500513520310230000000000000000000000000000000000000",
								"000000000000000000000000000500513520310231133201000000000000000000000000000000",
								"000000000000000000000000000500513520310231133201200000000000000000000000000000",
								"000000000000000000000000000500513520310231133231230000000000000000000000000000",
								"000000000000000000000000000500513520310231133331230100000000000000000000000000",
								"000000000000000000000000000500513520310231133331230152230050000300000000000000",
								"000000000000000000000000000500513520310231133331230152230050000300000000000000"
							};
						}
					}
				}
				else if (specialisation == "DruidBalance")
				{
					TalentsManager.Codes = new string[]
					{
						"5002000000000000000000000000000000000000000000000000000000000000000000000000000000000",
						"5032000100000000000000000000000000000000000000000000000000000000000000000000000000000",
						"5032003115001000000000000000000000000000000000000000000000000000000000000000000000000",
						"5032003115131032000000000000000000000000000000000000000000000000000000000000000000000",
						"5032003115131032013000000000000000000000000000000000000000000000000000000000000000000",
						"5032003115131033213003011000000000000000000000000000000000000000000000000000000000000",
						"5032003115131033213003311231000000000000000000000000000000000000000000000000000000000",
						"5032003115131033213003311231000000000000000000000000000000205003012000000000000000000",
						"5032003115131033213003311231000000000000000000000000000000205003312000000000000000000",
						"5032003115331033213005311231000000000000000000000000000000205003312000000000000000000"
					};
				}
			}
			else if (num != 3781932693U)
			{
				if (num == 3880399577U)
				{
					if (specialisation == "RogueAssassination")
					{
						TalentsManager.Codes = new string[]
						{
							"00532300535010052010333105100000000000000000000000000000000000000000000000000000000",
							"00532300535010052010333105100500500300000000000000000000000000000000000000000000000",
							"00532300535010052010333105100500500300000000000000000005020000000000000000000000000"
						};
					}
				}
			}
			else if (specialisation == "HunterSurvival")
			{
				TalentsManager.Codes = new string[]
				{
					"000000000000000000000000000000000000000000000000000005000032500033330523134301331",
					"000000000000000000000000000053051010000000000000000005000032500033330523134301331"
				};
			}
		}
		else if (num <= 4083020398U)
		{
			if (num != 3900185863U)
			{
				if (num == 4083020398U)
				{
					if (specialisation == "WarriorArms")
					{
						TalentsManager.Codes = new string[]
						{
							"3022032123330100202000000000000000000000000000000000000000000000000000000000000000000",
							"3022032123331100202012000000000000000000000000000000000000000000000000000000000000000",
							"3022032123333100202012013231251000000000000000000000000000000000000000000000000000000",
							"3022032123335100202012013231251000000000000000000000000000000000000000000000000000000",
							"3022032123335100202012013231251325050100000000000000000000000000000000000000000000000"
						};
					}
				}
			}
			else if (specialisation == "HunterBeastMastery")
			{
				TalentsManager.Codes = new string[]
				{
					"050002000000000000000000000000000000000000000000000000000000000000000000000000000",
					"052012015250120501000000000000000000000000000000000000000000000000000000000000000",
					"052012015250120531005010000000000000000000000000000000000000000000000000000000000",
					"152012015250120531005310510050052000000000000000000000000000000000000000000000000",
					"152012015250120531305310510052052300000000000000000000000000000000000000000000000"
				};
			}
		}
		else if (num != 4175387406U)
		{
			if (num == 4184541380U)
			{
				if (specialisation == "PriestHoly")
				{
					TalentsManager.Codes = new string[]
					{
						"0000000000000000000000000000032050030000000000000000000000000000000000000000000000",
						"0000000000000000000000000000034050032302122330000000000000000000000000000000000000",
						"0000000000000000000000000000034050032302142330000300000000000000000000000000000000",
						"0000000000000000000000000000034050032302152430000331351000000000000000000000000000",
						"0000000000000000000000000000235050032302152530000331351000000000000000000000000000",
						"0503203100000000000000000000235050032302152530000331351000000000000000000000000000"
					};
				}
			}
		}
		else if (specialisation == "DeathKnightFrost")
		{
			TalentsManager.Codes = new string[]
			{
				"0000000000000000000000000000320023503422030123000331013510000000000000000000000000000000",
				"0000000000000000000000000000320023503422030123000331013512302003050030000000000000000000",
				"0100000000000000000000000000320023503422030123000331013512302003050030000000000000000000"
			};
		}
	}

	// Token: 0x06000062 RID: 98 RVA: 0x00007BFC File Offset: 0x00005DFC
	private static void SetTalentCodes(string[] talentsCodes)
	{
		TalentsManager.Codes = talentsCodes;
	}

	// Token: 0x06000063 RID: 99 RVA: 0x00007C08 File Offset: 0x00005E08
	private void OnMovementPulse(List<Vector3> points, CancelEventArgs cancelable)
	{
		bool flag = TalentsManager.Codes == null;
		if (!flag)
		{
			bool flag2 = !Constants.Me.IsAlive;
			if (!flag2)
			{
				bool flag3 = !this.AssignTimer.IsReady;
				if (!flag3)
				{
					this.AssignTimer.Reset(300000.0);
					Main.LogDebug("Assigning Talents");
					TalentsManager.AssignTalents(TalentsManager.Codes);
				}
			}
		}
	}

	// Token: 0x17000006 RID: 6
	// (get) Token: 0x06000064 RID: 100 RVA: 0x00007C79 File Offset: 0x00005E79
	private static int AvailableTalentPoints
	{
		get
		{
			return Lua.LuaDoString<int>("local unspentTalentPoints, _ = UnitCharacterPoints('player'); return unspentTalentPoints;", "");
		}
	}

	// Token: 0x06000065 RID: 101 RVA: 0x00007C8C File Offset: 0x00005E8C
	private static ValueTuple<string, int, int> GetTalentInfo(int page, int talentNumber)
	{
		string[] array = Lua.LuaDoString<string>(string.Concat(new string[]
		{
			"return GetTalentInfo(",
			page.ToString(),
			", ",
			talentNumber.ToString(),
			");"
		}), "").Split(new string[]
		{
			"#||#"
		}, StringSplitOptions.None);
		return new ValueTuple<string, int, int>(array[0], int.Parse(array[4]), int.Parse(array[5]));
	}

	// Token: 0x06000066 RID: 102 RVA: 0x00007D0C File Offset: 0x00005F0C
	private static void AssignTalents(IEnumerable<string> TalentCodes)
	{
		bool flag = TalentsManager.AvailableTalentPoints <= 0;
		if (flag)
		{
			Main.LogDebug("No talent point to spend");
		}
		else
		{
			IEnumerable<string> enumerable = (TalentCodes as string[]) ?? TalentCodes.ToArray<string>();
			bool flag2 = !enumerable.Any<string>();
			if (flag2)
			{
				Main.LogError("No talent code");
			}
			else
			{
				List<int> list = new List<int>
				{
					Lua.LuaDoString<int>("return GetNumTalents(1)", ""),
					Lua.LuaDoString<int>("return GetNumTalents(2)", ""),
					Lua.LuaDoString<int>("return GetNumTalents(3)", "")
				};
				string[,] array = new string[4, 60];
				int[,] array2 = new int[4, 60];
				int[,] array3 = new int[4, 60];
				string[,] array4 = array;
				int[,] array5 = array2;
				int[,] array6 = array3;
				for (int i = 1; i <= 3; i++)
				{
					for (int j = 0; j < list[i - 1]; j++)
					{
						ref string ptr = ref array4[i, j];
						ref int ptr2 = ref array5[i, j];
						ref int ptr3 = ref array6[i, j];
						ValueTuple<string, int, int> talentInfo = TalentsManager.GetTalentInfo(i, j + 1);
						ptr = talentInfo.Item1;
						ptr2 = talentInfo.Item2;
						ptr3 = talentInfo.Item3;
					}
				}
				foreach (string text in enumerable)
				{
					bool flag3 = list[0] + list[1] + list[2] != text.Length;
					if (flag3)
					{
						Main.LogError("WARNING: Your talents code length is incorrect. Please use http://armory.twinstar.cz/talent-calc.php to generate valid codes.");
						Main.LogError("Talents code : " + text);
						break;
					}
					List<string> list2 = new List<string>
					{
						text.Substring(0, list[0]),
						text.Substring(list[0], list[1]),
						text.Substring(list[0] + list[1], list[2])
					};
					for (int k = 1; k <= 3; k++)
					{
						for (int l = 0; l < list[k - 1]; l++)
						{
							int talentNumber = l + 1;
							int num = (int)Convert.ToInt16(list2[k - 1].Substring(l, 1));
							string text2 = array4[k, l];
							int num2 = array5[k, l];
							int num3 = array6[k, l];
							string text3 = text2;
							int num4 = num2;
							int num5 = num3;
							bool flag4 = num4 > num && enumerable.Last<string>().Equals(text);
							if (flag4)
							{
								Main.LogError(string.Concat(new string[]
								{
									"WARNING: Your assigned talent points don't match your talent code. Please reset your talents or review your talents code. You have ",
									num4.ToString(),
									" point(s) in ",
									text3,
									" where you should have ",
									num.ToString(),
									" point(s)"
								}));
								Main.LogError("Talents code : " + text);
								return;
							}
							bool flag5 = num > num5;
							if (flag5)
							{
								Main.LogError(string.Format("WARNING : You're trying to assign {0} points into {1},", num, text3) + string.Format(" maximum is {0} points for this talent. Please check your talent code.", num5));
								Main.LogError("Talents code : " + text);
								return;
							}
							bool flag6 = num4 == num;
							if (!flag6)
							{
								for (int m = 0; m < num - num4; m++)
								{
									Lua.LuaDoString(string.Concat(new string[]
									{
										"LearnTalent(",
										k.ToString(),
										", ",
										talentNumber.ToString(),
										")"
									}), false);
									Thread.Sleep(500 + Usefuls.Latency);
									ref int ptr4 = ref array5[k, l];
									ValueTuple<string, int, int> talentInfo = TalentsManager.GetTalentInfo(k, talentNumber);
									ptr4 = talentInfo.Item2;
									Main.Log(string.Concat(new string[]
									{
										"Assigned talent: ",
										text3,
										" : ",
										array5[k, l].ToString(),
										"/",
										num.ToString()
									}));
									bool flag7 = TalentsManager.AvailableTalentPoints <= 0;
									if (flag7)
									{
										return;
									}
								}
							}
						}
					}
				}
			}
		}
	}

	// Token: 0x06000067 RID: 103 RVA: 0x000081C0 File Offset: 0x000063C0
	public void Initialize()
	{
		MovementEvents.OnMovementPulse += new MovementEvents.MovementCancelableHandler(this.OnMovementPulse);
	}

	// Token: 0x06000068 RID: 104 RVA: 0x000081D4 File Offset: 0x000063D4
	public void Dispose()
	{
		MovementEvents.OnMovementPulse -= new MovementEvents.MovementCancelableHandler(this.OnMovementPulse);
	}

	// Token: 0x04000030 RID: 48
	private static string[] Codes;

	// Token: 0x04000031 RID: 49
	private readonly Timer AssignTimer = new Timer();
}
